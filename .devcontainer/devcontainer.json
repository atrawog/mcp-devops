{
  "name": "MCP DevOps",
  "build": {
    "dockerfile": "../Dockerfile",
    "context": ".."
    // Build args removed - Dockerfile uses default UID/GID 1000
    // updateRemoteUserUID will handle runtime UID sync
  },
  "runArgs": [
    "--hostname=mcp-devops",
    "--privileged",
    "--cap-add=SYS_PTRACE",
    "--security-opt", "seccomp=unconfined",
    "--shm-size=2g"
    // Removed --user flag - not needed with updateRemoteUserUID
  ],
  "forwardPorts": [5900],
  "portsAttributes": {
    "5900": {
      "label": "VNC",
      "onAutoForward": "notify",
      "protocol": "tcp"
    }
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-azuretools.vscode-docker",
        "kokakiwi.vscode-just",
        "ms-vscode.makefile-tools",
        "ms-kubernetes-tools.vscode-kubernetes-tools"
      ],
      "settings": {
        "terminal.integrated.defaultProfile.linux": "bash",
        "remote.autoForwardPorts": true,
        "files.watcherExclude": {
          "**/target/**": true
        }
      }
    }
  },
  // Features removed - incompatible with Arch Linux
  // Docker and git are installed directly in the Dockerfile instead
  // Lifecycle commands
  "onCreateCommand": "echo 'Container created successfully'",
  "updateContentCommand": "sudo pacman -Syu --noconfirm",
  "postCreateCommand": "sudo chown -R jovian:jovian /workspace /home/jovian/.config 2>/dev/null || true",
  "postStartCommand": "sudo /usr/local/bin/sync-docker-gid.sh && echo 'DevContainer ready!'",
  "postAttachCommand": "echo 'Welcome to MCP DevOps DevContainer'",
  
  // User configuration following Dev Container spec
  "remoteUser": "jovian",
  "updateRemoteUserUID": true,
  // containerUser removed (deprecated - remoteUser is used instead)
  
  // Workspace configuration
  "workspaceFolder": "/workspace",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
  
  // Additional mounts
  "mounts": [
    // Mount Docker socket for Docker outside of Docker (safer than Docker-in-Docker)
    "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
  ],
  
  // Environment variables
  "containerEnv": {
    "PROJECT_NAME": "mcp-devops",
    "DISPLAY": ":0",
    "WLR_BACKENDS": "headless",
    "WLR_LIBINPUT_NO_DEVICES": "1",
    "WLR_SEAT": "seat0",
    "XDG_RUNTIME_DIR": "/tmp/runtime-jovian",
    "WAYLAND_DISPLAY": "wayland-1",
    "VNC_PASSWORD": "mcp-devops"
  },
  
  // Override the default command to use s6-init
  "overrideCommand": false
}